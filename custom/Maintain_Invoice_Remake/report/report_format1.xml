<!--Custom report.-->
<odoo>
<data>
    <template id="report_invoice_format1">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-set="lang" t-value="o.invoice_user_id.sudo().lang if o.type in ('in_invoice', 'in_refund') else o.partner_id.lang"/>
                <t t-call="Maintain_Invoice_Remake.report_invoice_document1" t-lang="lang"/>
            </t>
        </t>
    </template>
    <template id="report_invoice_document1">
        <t t-call="Maintain_Invoice_Remake.report_layout1">
            <t t-set="o" t-value="o.with_context(lang=lang)" />
            <t t-set="display_discount" t-value="any([l.discount for l in o.invoice_line_ids])"/>
            <div class="content-table" style="border: 2px solid #439eb2;">
                <div style="min-height: 400px">
                    <table border="0" cellspacing="0" style="width: 100%; font-size: 12px;">
                        <thead>
                            <tr>
                                <td style="border: 1px solid #439eb2; border-left: 0; border-top: 0; border-right: 0; text-align: left; width: 60px; background-color: #e0e0e0" name="th_id"><span>明細</span></td>
                                <td style="border: 1px solid #439eb2; border-top: 0; border-right: 0; text-align: left; width: 500px; background-color: #e0e0e0" name="th_description"><span>品目コード:品目名称<br/>説明/備考</span></td>
                                <td style="border: 1px solid #439eb2; border-top: 0; border-right: 0; text-align: right; background-color: #e0e0e0" name="th_priceunit" ><span>数量<br/>単位</span></td>
                                <td style="border: 1px solid #439eb2; border-top: 0; border-right: 0; text-align: right; background-color: #e0e0e0" name="th_taxes"><span>単価<br/>定価</span></td>
                                <td style="border: 1px solid #439eb2; border-top: 0; border-right: 0; text-align: right; background-color: #e0e0e0" name="th_subtotal">行合計<br/>税金情報</td>
                            </tr>
                        </thead>
                        <tbody class="invoice_tbody">
                            <t t-set="current_subtotal" t-value="0"/>
                            <t t-set="lines" t-value="o.invoice_line_ids.sorted(key=lambda l: (-l.invoice_custom_line_no), reverse=True)"/>

                            <t t-foreach="lines" t-as="line">
                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                                <tr>
                                    <td style="border: 1px solid #439eb2; border-top: 0; border-right: 0; border-left: 0; text-align: left; width: 60px">
                                        <span t-field="line.invoice_custom_line_no"/>
                                    </td>
                                    <td style="border: 1px solid #439eb2; border-right: 0; border-top: 0; text-align: left; width: 500px" class="text-right">
                                        <span t-field="line.product_id.product_custom_search_key"/>: <span t-field="line.product_id.name"/>
                                    </td>
                                    <td style="border: 1px solid #439eb2; border-right: 0; border-top: 0; text-align: right">
                                        <span t-field="line.quantity"/><br/>
                                        <span t-field="line.product_id.uom_id"/>
                                    </td>
                                    <td style="border: 1px solid #439eb2; border-right: 0; border-top: 0; text-align: right">
                                        <span t-field="line.price_unit"/><br/>
                                        <span t-field="line.product_id.list_price"/>
                                    </td>
                                    <td style="border: 1px solid #439eb2; border-right: 0; border-top: 0; text-align: right">
                                        <span t-field="line.price_subtotal"/><br/>
                                        <t t-foreach="line.tax_ids" t-as="tax">
                                            <span t-field="tax.name"/>
                                        </t>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </div>
                <div style="height: 42px"/>
                <table border="0" cellspacing="0" style="width: 100%; font-size: 12px">
                    <tbody>
                        <tr>
                            <td colspan="2" style="border: 1px solid #439eb2; border-right: 0; border-left: 0; border-bottom: 0; width: 400px">備考: <span t-field="o.x_studio_description"/></td>
                            <td colspan="3" style="padding: 0">
                                <table style="width: 100%" border="0" cellspacing="0">
                                    <tr>
                                        <td style="border: 1px solid #439eb2; border-right: 0; border-bottom: 0; width: 150px; background-color: #e0e0e0; text-align: center">
                                            <span>明細行合計</span>
                                        </td>
                                        <td style="border: 1px solid #439eb2; border-bottom: 0; border-right: 0; text-align: right;">
                                            <span t-field="o.amount_untaxed"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #439eb2; border-right: 0; border-bottom: 0; background-color: #e0e0e0; text-align: center;"><span>税　額</span></td>
                                        <td style="border: 1px solid #439eb2; border-bottom: 0; border-right: 0; text-align: right;">
                                            <t t-foreach="o.amount_by_group" t-as="tax">
                                                <div><span t-esc="tax[3]"/></div>
                                            </t>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #439eb2; border-right: 0; border-bottom: 0; background-color: #e0e0e0; text-align: center;"><span>総　合　計</span></td>
                                        <td style="border: 1px solid #439eb2; border-bottom: 0; border-right: 0; text-align: right;"><span t-field="o.amount_total"/></td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #439eb2; border-bottom: 0; border-right: 0; background-color: #e0e0e0; text-align: center"><span>支払期日</span></td>
                                        <td style="border: 1px solid #439eb2; border-bottom: 0; border-right: 0; text-align: right;"><span t-field="o.x_due_date"/></td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </t>
    </template>
</data>
</odoo>